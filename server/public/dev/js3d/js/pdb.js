var PDB = {};

PDB.load = function(file) {
  var atoms = [];
  
  var lines = file.split(/[\n|\r]+/);  
  
  for(var i = 0; i < lines.length; i++) {
    var line = lines[i].replace(/^\s+|\s+$/g, '');
    if(line.substring(0, 4) != 'ATOM') continue;
    
    var symbol = line.substring(13, 17).replace(/^\s+|\s+$/g, '');
    var coordinates = line.substring(32).replace(/^\s+|\s+$/g, '').split(/\s+/);
    
    atoms.push({
      'symbol': symbol,
      'coordinates': [parseFloat(coordinates[0]), parseFloat(coordinates[1]), parseFloat(coordinates[2])]
    })
  }
  
  return atoms;
}



var bucky_pdb = "\
HEADER    MOLECULE\n\
COMPND    C60 (BUCKMINSTERFULLERENE)\n\
AUTHOR    A. W. MAVERICK\n\
ATOM      1  C   MOL     1      -1.168  -3.284  -0.100  1.00  0.00\n\
ATOM      2  C   MOL     1      -0.588  -3.148  -1.380  1.00  0.00\n\
ATOM      3  C   MOL     1       0.808  -3.164  -1.228  1.00  0.00\n\
ATOM      4  C   MOL     1       1.096  -3.308   0.140  1.00  0.00\n\
ATOM      5  C   MOL     1      -0.124  -3.384   0.836  1.00  0.00\n\
ATOM      6  C   MOL     1      -2.340  -2.576   0.216  1.00  0.00\n\
ATOM      7  C   MOL     1      -2.472  -1.968   1.480  1.00  0.00\n\
ATOM      8  C   MOL     1      -1.428  -2.064   2.420  1.00  0.00\n\
ATOM      9  C   MOL     1      -0.256  -2.776   2.096  1.00  0.00\n\
ATOM     10  C   MOL     1       0.836  -2.088   2.664  1.00  0.00\n\
ATOM     11  C   MOL     1       2.056  -2.012   1.972  1.00  0.00\n\
ATOM     12  C   MOL     1       2.184  -2.624   0.708  1.00  0.00\n\
ATOM     13  C   MOL     1       2.992  -1.792  -0.096  1.00  0.00\n\
ATOM     14  C   MOL     1       2.704  -1.648  -1.464  1.00  0.00\n\
ATOM     15  C   MOL     1       1.612  -2.332  -2.032  1.00  0.00\n\
ATOM     16  C   MOL     1       1.016  -1.488  -2.988  1.00  0.00\n\
ATOM     17  C   MOL     1      -0.380  -1.472  -3.140  1.00  0.00\n\
ATOM     18  C   MOL     1      -1.184  -2.304  -2.336  1.00  0.00\n\
ATOM     19  C   MOL     1      -2.360  -1.596  -2.012  1.00  0.00\n\
ATOM     20  C   MOL     1      -2.936  -1.732  -0.736  1.00  0.00\n\
ATOM     21  C   MOL     1       1.740  -0.276  -3.012  1.00  0.00\n\
ATOM     22  C   MOL     1       2.784  -0.376  -2.068  1.00  0.00\n\
ATOM     23  C   MOL     1       3.360  -0.668   0.668  1.00  0.00\n\
ATOM     24  C   MOL     1       2.780  -0.804   1.948  1.00  0.00\n\
ATOM     25  C   MOL     1       0.336  -0.956   3.340  1.00  0.00\n\
ATOM     26  C   MOL     1      -1.064  -0.940   3.188  1.00  0.00\n\
ATOM     27  C   MOL     1      -3.436  -0.596  -0.064  1.00  0.00\n\
ATOM     28  C   MOL     1      -3.148  -0.740   1.304  1.00  0.00\n\
ATOM     29  C   MOL     1      -2.280  -0.324  -2.620  1.00  0.00\n\
ATOM     30  C   MOL     1      -1.056  -0.248  -3.316  1.00  0.00\n\
ATOM     31  C   MOL     1       1.056   0.248   3.316  1.00  0.00\n\
ATOM     32  C   MOL     1       2.280   0.324   2.620  1.00  0.00\n\
ATOM     33  C   MOL     1       3.436   0.596   0.064  1.00  0.00\n\
ATOM     34  C   MOL     1       3.148   0.744  -1.304  1.00  0.00\n\
ATOM     35  C   MOL     1       1.064   0.940  -3.188  1.00  0.00\n\
ATOM     36  C   MOL     1      -0.336   0.956  -3.340  1.00  0.00\n\
ATOM     37  C   MOL     1      -3.360   0.668  -0.668  1.00  0.00\n\
ATOM     38  C   MOL     1      -2.780   0.804  -1.948  1.00  0.00\n\
ATOM     39  C   MOL     1      -2.784   0.376   2.068  1.00  0.00\n\
ATOM     40  C   MOL     1      -1.740   0.276   3.012  1.00  0.00\n\
ATOM     41  C   MOL     1       2.360   1.596   2.012  1.00  0.00\n\
ATOM     42  C   MOL     1       2.936   1.732   0.736  1.00  0.00\n\
ATOM     43  C   MOL     1       1.428   2.064  -2.420  1.00  0.00\n\
ATOM     44  C   MOL     1       2.472   1.968  -1.480  1.00  0.00\n\
ATOM     45  C   MOL     1      -0.836   2.088  -2.668  1.00  0.00\n\
ATOM     46  C   MOL     1      -2.056   2.012  -1.972  1.00  0.00\n\
ATOM     47  C   MOL     1      -2.992   1.792   0.092  1.00  0.00\n\
ATOM     48  C   MOL     1      -2.704   1.648   1.464  1.00  0.00\n\
ATOM     49  C   MOL     1      -1.016   1.488   2.988  1.00  0.00\n\
ATOM     50  C   MOL     1       0.380   1.472   3.140  1.00  0.00\n\
ATOM     51  C   MOL     1      -1.612   2.332   2.032  1.00  0.00\n\
ATOM     52  C   MOL     1       1.184   2.304   2.336  1.00  0.00\n\
ATOM     53  C   MOL     1       2.340   2.576  -0.216  1.00  0.00\n\
ATOM     54  C   MOL     1       0.256   2.776  -2.096  1.00  0.00\n\
ATOM     55  C   MOL     1      -2.188   2.624  -0.708  1.00  0.00\n\
ATOM     56  C   MOL     1      -0.808   3.164   1.228  1.00  0.00\n\
ATOM     57  C   MOL     1       0.588   3.148   1.380  1.00  0.00\n\
ATOM     58  C   MOL     1       1.168   3.284   0.100  1.00  0.00\n\
ATOM     59  C   MOL     1       0.124   3.384  -0.836  1.00  0.00\n\
ATOM     60  C   MOL     1      -1.096   3.308  -0.140  1.00  0.00\n\
TER      61      MOL     1 \n\
END   \n\
"


var diamond_pdb = "\
HEADER    MOLECULE\n\
COMPND    DIAMOND\n\
AUTHOR    A. W. MAVERICK\n\
ATOM      1  C3  MOL     1      -1.776  -1.780  -1.780  1.00  0.00\n\
ATOM      2  C3  MOL     1      -1.776  -1.780   1.776  1.00  0.00\n\
ATOM      3  C3  MOL     1      -1.776  -0.004  -0.004  1.00  0.00\n\
ATOM      4  C3  MOL     1      -1.776   1.776  -1.780  1.00  0.00\n\
ATOM      5  C3  MOL     1      -1.776   1.776   1.776  1.00  0.00\n\
ATOM      6  C3  MOL     1       0.000  -1.780  -0.004  1.00  0.00\n\
ATOM      7  C3  MOL     1       0.000  -0.004  -1.780  1.00  0.00\n\
ATOM      8  C3  MOL     1       0.000  -0.004   1.776  1.00  0.00\n\
ATOM      9  C3  MOL     1       0.000   1.776  -0.004  1.00  0.00\n\
ATOM     10  C3  MOL     1       1.780  -1.780  -1.780  1.00  0.00\n\
ATOM     11  C3  MOL     1       1.780  -1.780   1.776  1.00  0.00\n\
ATOM     12  C3  MOL     1       1.780  -0.004  -0.004  1.00  0.00\n\
ATOM     13  C3  MOL     1       1.780   1.776  -1.780  1.00  0.00\n\
ATOM     14  C3  MOL     1       1.780   1.776   1.776  1.00  0.00\n\
ATOM     15  C3  MOL     1      -0.888  -0.892  -0.892  1.00  0.00\n\
ATOM     16  C3  MOL     1      -0.888   0.888   0.888  1.00  0.00\n\
ATOM     17  C3  MOL     1       0.892  -0.892   0.888  1.00  0.00\n\
ATOM     18  C3  MOL     1       0.892   0.888  -0.892  1.00  0.00\n\
TER      19      MOL     1 \n\
END   \n\
"


var PbTiO3 = "\
HEADER    MOLECULE\n\
COMPND    LEAD TITANATE (A PEROVSKITE)\n\
AUTHOR    A. W. MAVERICK\n\
ATOM      1  O     UNK   1      -1.952  -6.225   1.952  1.00  0.00\n\
ATOM      2  O     UNK   1      -1.952  -6.225  -1.952  1.00  0.00\n\
ATOM      3  O     UNK   1       1.952  -6.225   1.952  1.00  0.00\n\
ATOM      4  O     UNK   1       1.952  -6.225  -1.952  1.00  0.00\n\
ATOM      5  O     UNK   1      -3.904  -4.673   1.952  1.00  0.00\n\
ATOM      6  O     UNK   1      -3.904  -4.673  -1.952  1.00  0.00\n\
ATOM      7  O     UNK   1      -1.952  -4.673   3.904  1.00  0.00\n\
ATOM      8  O     UNK   1      -1.952  -4.673   0.000  1.00  0.00\n\
ATOM      9  O     UNK   1      -1.952  -4.673  -3.904  1.00  0.00\n\
ATOM     10  O     UNK   1       0.000  -4.673   1.952  1.00  0.00\n\
ATOM     11  O     UNK   1       0.000  -4.673  -1.952  1.00  0.00\n\
ATOM     12  O     UNK   1       1.952  -4.673   3.904  1.00  0.00\n\
ATOM     13  O     UNK   1       1.952  -4.673   0.000  1.00  0.00\n\
ATOM     14  O     UNK   1       1.952  -4.673  -3.904  1.00  0.00\n\
ATOM     15  O     UNK   1       3.904  -4.673   1.952  1.00  0.00\n\
ATOM     16  O     UNK   1       3.904  -4.673  -1.952  1.00  0.00\n\
ATOM     17  O     UNK   1      -1.952  -2.075   1.952  1.00  0.00\n\
ATOM     18  O     UNK   1      -1.952  -2.075  -1.952  1.00  0.00\n\
ATOM     19  O     UNK   1       1.952  -2.075   1.952  1.00  0.00\n\
ATOM     20  O     UNK   1       1.952  -2.075  -1.952  1.00  0.00\n\
ATOM     21  O     UNK   1      -3.904  -0.523   1.952  1.00  0.00\n\
ATOM     22  O     UNK   1      -3.904  -0.523  -1.952  1.00  0.00\n\
ATOM     23  O     UNK   1      -1.952  -0.523   3.904  1.00  0.00\n\
ATOM     24  O     UNK   1      -1.952  -0.523   0.000  1.00  0.00\n\
ATOM     25  O     UNK   1      -1.952  -0.523  -3.904  1.00  0.00\n\
ATOM     26  O     UNK   1       0.000  -0.523   1.952  1.00  0.00\n\
ATOM     27  O     UNK   1       0.000  -0.523  -1.952  1.00  0.00\n\
ATOM     28  O     UNK   1       1.952  -0.523   3.904  1.00  0.00\n\
ATOM     29  O     UNK   1       1.952  -0.523   0.000  1.00  0.00\n\
ATOM     30  O     UNK   1       1.952  -0.523  -3.904  1.00  0.00\n\
ATOM     31  O     UNK   1       3.904  -0.523   1.952  1.00  0.00\n\
ATOM     32  O     UNK   1       3.904  -0.523  -1.952  1.00  0.00\n\
ATOM     33  O     UNK   1      -1.952   2.075   1.952  1.00  0.00\n\
ATOM     34  O     UNK   1      -1.952   2.075  -1.952  1.00  0.00\n\
ATOM     35  O     UNK   1       1.952   2.075   1.952  1.00  0.00\n\
ATOM     36  O     UNK   1       1.952   2.075  -1.952  1.00  0.00\n\
ATOM     37  O     UNK   1      -3.904   3.627   1.952  1.00  0.00\n\
ATOM     38  O     UNK   1      -3.904   3.627  -1.952  1.00  0.00\n\
ATOM     39  O     UNK   1      -1.952   3.627   3.904  1.00  0.00\n\
ATOM     40  O     UNK   1      -1.952   3.627   0.000  1.00  0.00\n\
ATOM     41  O     UNK   1      -1.952   3.627  -3.904  1.00  0.00\n\
ATOM     42  O     UNK   1       0.000   3.627   1.952  1.00  0.00\n\
ATOM     43  O     UNK   1       0.000   3.627  -1.952  1.00  0.00\n\
ATOM     44  O     UNK   1       1.952   3.627   3.904  1.00  0.00\n\
ATOM     45  O     UNK   1       1.952   3.627   0.000  1.00  0.00\n\
ATOM     46  O     UNK   1       1.952   3.627  -3.904  1.00  0.00\n\
ATOM     47  O     UNK   1       3.904   3.627   1.952  1.00  0.00\n\
ATOM     48  O     UNK   1       3.904   3.627  -1.952  1.00  0.00\n\
ATOM     49  O     UNK   1      -1.952   6.225   1.952  1.00  0.00\n\
ATOM     50  O     UNK   1      -1.952   6.225  -1.952  1.00  0.00\n\
ATOM     51  O     UNK   1       1.952   6.225   1.952  1.00  0.00\n\
ATOM     52  O     UNK   1       1.952   6.225  -1.952  1.00  0.00\n\
ATOM     53 PB     UNK   1       0.000  -2.540   0.000  1.00  0.00\n\
ATOM     54 PB     UNK   1       0.000   1.610   0.000  1.00  0.00\n\
ATOM     55 TI     UNK   1      -1.952  -4.445   1.952  1.00  0.00\n\
ATOM     56 TI     UNK   1      -1.952  -0.295   1.952  1.00  0.00\n\
ATOM     57 TI     UNK   1      -1.952   3.855   1.952  1.00  0.00\n\
ATOM     58 TI     UNK   1      -1.952  -4.445  -1.952  1.00  0.00\n\
ATOM     59 TI     UNK   1      -1.952  -0.295  -1.952  1.00  0.00\n\
ATOM     60 TI     UNK   1      -1.952   3.855  -1.952  1.00  0.00\n\
ATOM     61 TI     UNK   1       1.952  -4.445   1.952  1.00  0.00\n\
ATOM     62 TI     UNK   1       1.952  -0.295   1.952  1.00  0.00\n\
ATOM     63 TI     UNK   1       1.952   3.855   1.952  1.00  0.00\n\
ATOM     64 TI     UNK   1       1.952  -4.445  -1.952  1.00  0.00\n\
ATOM     65 TI     UNK   1       1.952  -0.295  -1.952  1.00  0.00\n\
ATOM     66 TI     UNK   1       1.952   3.855  -1.952  1.00  0.00\n\
END\n\
"
